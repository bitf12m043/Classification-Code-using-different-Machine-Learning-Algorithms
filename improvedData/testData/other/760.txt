Date Tue Dec GMT Server NCSA Content type text html Last modified Thu Dec GMT Content length GNU Emacs for Windows and Windows GNU Emacs Windows and Windows The latest release See the section below the changes between and Emacs won start anymore See troubleshooting below Last modified December Table ContentsWhich versions and Win are supported Related ports MSDOS and Windows MULEChanges between and How get Emacs distribution Where can get the source distribution Where can get precompiled versions How unpack the distributions don want the precompiled version How compile Emacs myself How install Emacs When run Emacs nothing happens What the deal Emacs used work fine But now won start and didn change anything Emacs Why does Emacs ask connect dialup service when starts When run Emacs console window pops How make away Where put emacs emacs file How swap CapsLock and Control How change the size position font and color attributes Emacs Windows Interface Size Position Fonts and Colors Customizing frame appearances Information italic fonts Console Interface Size Position Fonts and Colors How use Emacs with two button mouse How highlight the region between the point and the mark How change the sound the Emacs beep How display ISO characters Subprocesses under EmacsPrograms reading input hangBuffering shellsDOS subprocessesHow use shell Emacs How prevent shell commands from being echoed Why Specified COMMAND search directory bad message printed Within shell when run programs get Incorrect DOS version messages Why How use mail with Emacs OutgoingIncoming RMAIL and POP Incoming and POP Incoming GNUStmHow use ange ftp with Emacs How use telnet with Emacs How use crypt with Emacs How use the browse url package How print from Emacs How associate files with Emacs How access UNIX files via NFS there package for editing Windows specific files bat ini inf etc there mode for editing Visual Basic source there version RCS for Win there version ispell for Win Does Emacs support popup menus BUGSI get these strange error messages What wrong shell etc fails with Invalid read syntax shell etc fails with Symbol value variable void Symbol value variable void pressions produces Can spawn Win Specific ProblemsI get these Out environment space messages Why The ESC key doesn seem work Win Why Emacs doesn refresh correctly Why When will the Win version have subprocess support Patches What other Unix tools have been ported and Windows What the name the Emacs mailing list Where are the archives for ntemacs users Which versions and Win are supported This port known run all versions including with the beta Win shell all hardware platforms and Windows beta version and later versions This port built using the Win API and supports most the features the Unix version Note that this port does not work with Win and not know enough about Win know whether either possible even worth trying MSDOS and Windows Eli Zaretskii lteliz elta maintains the port GNU Emacs for MSDOS and Windows You can download precompiled versions with the latest DJGPP archives ftp ftp simtel net pub simtelnet gnu djgpp gnu emacs READMEftp ftp simtel net pub simtelnet gnu djgpp gnu zip Eli strongly recommends that you start with the emacs README file contains crucial info about what the other zip files and how install them and get started with Emacs MSDOS Windows platforms More from Eli might interest Windows users that this version Emacs supports long filenames Windows only and the Windows clipboard all versions Windows also supports multiple frames but they all overlap like when Emacs runs glass teletype terminal People who would like run Emacs plain DOS opposed Windows will need download and install DPMI host this URL ftp ftp simtel net pub simtelnet gnu djgpp misc csdpmi zipMULE Hisashi Miyashita lthimi bird scphys kyoto maintains MULE multilingual Emacs You can get distributions MULE ftp ftp tokyonet pub misc mule win Changes between and far Emacs Win are concerned and released within weeks each other are essentially the same Emacs now loads winsock dll dynamically get around the problem where starting Emacs would force network connection made machines configured use the dialup network Two new functions win has winsock and win unload winsock determine whether winsock has been loaded and load not and unload winsock respectively The registry entry PRELOAD WINSOCK can set have winsock loaded when Emacs starts for machines that are always connected the network Bug fixes the rename function which Win does some shuffling overcome bug MoveFile the new name only different case the old name the old file not deleted Also the temporary file name now uses long extension ensure that Win names the renamed file properly The Alt key can now used generate the alt modifier default use Alt generate the meta modifier New variable win alt meta when non nil has Alt generate the alt modifier Emacs now repaints the backgrounds properly when occluded Fixed width fonts any quality precision are now allowed DOS processes restricted well Win Bug fix mouse positioning Driver letters now always lower cased Improvements keyboard handling Emacs longer loses modifier key state when switching back and forth among applications now also processes valid keys that are produced using AltGr with dead keys The strange behavior Emacs hanging when pressed repeatedly upon startup console mode has also been fixed New variable win downcase file names When non nil upper case filenames are converted lower case DOS subprocesses longer can killed via signals Improvements shell mode can now complete filenames that include the path separator and defaults the path separator for completed names can also expand environment variable references using the ENV VAR syntax does better job following directory changes although can still get confused you switch among drives The smtpmail file now the standard distribution mode now properly quotes checkin messages TAGS files are now computed and loaded text The wakeup program has been removed across all platforms now that Emacs internally supports timers How get Emacs distribution Emacs distributed two different forms You can get the full source distribution Emacs you can get installed distribution Emacs with all executables precompiled Where can get the source distribution The latest source distribution can found ftp washington edu pub ntemacs latest src distributed two formats one large gzipped tar file emacs tar and collection smaller zip files that can copied Mbyte floppies src zip the same directory you should also find patch files that enable you upgrade source distributions the latest version These patch files are mirrors the ones the FSF server ftp ftp gnu mit edu pub gnu Where can get precompiled versions Precompiled versions always exist for and Win When receive contributed precompiled versions from other users the other platforms place them the appropriate directory the link ends empty nonexistant directory then haven received any precompiled executables for that platform this case you have Microsoft compiler then you can download the source and compile and you please consider contributing your executables send mail and can make arrangements for making them available ftp server Links precompiled versions ftp washington edu pub ntemacs latest mips ftp washington edu pub ntemacs latest mipsalpha ftp washington edu pub ntemacs latest alphappc ftp washington edu pub ntemacs latest ppcwin ftp washington edu pub ntemacs latest both and Win had numerous reports from people outside North America stating that their ftp connection aborts for apparent reason roughly third the way through transfer full distribution Marc Haber haber ira uka said that suffered from the same problem and later found that timeout configured into his WWW proxy would cancel the transfer when the link the was very busy Going around his proxy solved the problem Other than that have not been able figure out why this might the case this happens you you might consider trying download the chunks try one the mirror sites Also you have access standalone ftp client separate from your web browser you should definitely try that well Mirror sites with precompiled versions Ireland ftp ftp ucc pub emacs all Australia http www plugged net gnu ntemacs North America East Coast http www itribe net virtunix emacs How unpack the distributions Decide directory which place Emacs Move the distribution that directory and then unpack you have the gzipped tar version first use gunzip uncompress the tar file and then use tar with the xvfm flags extract the files from the tar file gunzip emacs tar tar xvfm The flag forces gunzip decompress its behavior depends upon the name the executable and sometimes doesn recognize that really gunzip and the flag tells pipe its output stdout Similarly the flag tar tells read the tar file from stdin Unpacking the distribution this way leaves the distribution compressed form takes less space for some reason you also want have the tar file gunzipped then invoke gunzip without the option gunzip emacs tar you have the zip version use unzip with the flag all the zip files note that you cannot use pkunzip these files pkunzip will not preserve the long filenames unzip emacs zip repeat for the remaining zip files You can find precompiled versions all the compression and archive utilities ftp washington edu pub ntemacs utilities WARNING Some utilities that handle tar files can incorrectly untar the distributions when using the default settings you encounter problems with Emacs see the section below troubleshooting these problems Now what You should find file named README part the distribution sure read this file for information installing Emacs well reading the section below installing Emacs don want the precompiled version How compile Emacs myself compile Emacs you will need Microsoft compiler package For this can any the SDK compilers from and Microsoft Visual for versions and Microsoft Visual versions and For Windows this can Microsoft Visual versions and Download and place the source distribution directory say emacs Unpack the distribution and the subdirectory the emacs directory that gets created the unpacking process Read the README and INSTALL files included with the distribution for the full details this process Below are known problems with various combinations Emacs versions and compiler versions The problems are being addressed later versions and are included here that you know expect them and how work around them Emacs and MSVC win mak For some reason the MSVC installation process does not install win mak which included the file ntwin mak You have copy over the win mak file into the MSVC include directory before the Emacs makefiles will work PROCESSOR macros Although the PROCESSOR macros are defined the manual MSVC longer defines the full set PROCESSOR macros winnt You have comment the macros out get compile How install Emacs Precompiled distribution Preferred method Let assume that the directory which you have unpacked Emacs emacs note that can anything you want just want able refer something concrete this point First you will want run the program bin addpm exe with the Emacs directory argument this example you would invoke emacs bin addpm exe emacs Invoking addpm exe will two things First will create set registry keys that tell Emacs where find its support files lisp info etc Second will create folder containing icon linked runemacs exe wrapper program for invoking Emacs Now run Emacs simply click the icon the newly created folder invoke runemacs exe from command prompt Alternate method Another alternative for running Emacs use the emacs bat batch file the bin directory this now the old method invoking Emacs Edit the emacs bat file change the emacs dir environment variable point the Emacs installation directory and invoke the emacs bat file run Emacs you use bash your shell you can use equivalent bash script emacs bat Note that Win you are likely get Out environment space messages when invoking the emacs bat batch file The problem that the console process which the script executed runs out memory which set the Emacs environment variables get around this problem create shortcut icon the emacs bat script Then right click the icon and select Properties the dialog box that pops select the Memory tab and then change the Environment memory allocation from Auto Close the dialog box and then double click the icon start Emacs Source distributionYou have two options for installing Emacs with the source distribution You can install over the source directory you can install completely separate directory Emacs works the same with either installation option One advantage installing over the source directory that takes far less disk space primarly because the lisp files don have copied One advantage installing Emacs separate directory that Emacs can now managed single unit that can moved and copied independently the source code The INSTALL DIR macro the makefile def makefile determines where Emacs will get installed from the source distribution you want install Emacs the same directory the source tree say src emacs then simply set INSTALL DIR appropriately INSTALL DIR src emacs you want install Emacs different directory say emacs then set INSTALL DIR this directory INSTALL DIR emacs compared with the installation process for the precompiled version the installation process will automatically create bin emacs bat file the installation tree with the emacs dir variable set appropriately When run Emacs nothing happens What the deal Emacs could have failed run for number reasons The most common symptom that when Emacs started the cursor changes for second but nothing happens this happens you quite likely that the distribution was unpacked incorrectly you are using machine that uses dialup networking then also possible that Emacs trying resolve your machine domain name winsock dll being loaded See the next section for more info working around this problem check for the following see there was problem during unpacking sure disable the translation the executables will unusable Older versions WinZipNT would enable this translation default you are using WinZipNT disable Check that filenames were not truncated For example there should file lisp term win win this has been truncated win your distribution has been corrupted while unpacking and Emacs will not start been told that some utilities WinZip again don create the lock subdirectory The lock subdirectory needs created also had reports that the gnu win tar corrupts the executables Use the version tar ftp site instead you are doubt about whether the utilities you used unpacked the distribution incorrectly use the gunzip tar and unzip executables provided the utilities directory These are the ones use create and test the distributions advice would use these utilities from the start you feel certain that you have unpacked the distribution correctly then you should check make sure that the emacs dir variable the emacs bat file set correctly and you are still having trouble make sure that absolute path that includes the drive letter UNC format still not working send mail send mail the list Emacs used work fine But now won start and didn change anything Emacs The typical behavior people are encountering with this problem that they invoke Emacs but either nothing happens produces access violation and yet they have changed nothing their Emacs installation and Emacs used work fine before this point Most likely the problem due interaction between Emacs and some new piece software you have just installed the most popular culprit seems HeapAgent Due the nature which Emacs designed and built Emacs fundamentally non relocatable uses initialized heap segment that needs mapped particular virtual address startup time before Emacs will work correctly appears that programs like HeapAgent install DLLs that intrude upon Emacs virtual address space preventing Emacs load its initialized heap you have HeapAgent then you can work around the problem two ways You can download the source and recompile described below you can use editbin change the base address which the haloader dll dll will loaded this the dll that gets loaded into every application address space startup editbin rebase base haloader dll Otherwise the only other workaround recompile Emacs your machine that Emacs creates and initializes its heap virtual address that does not conflict with software such HeapAgent this you will need download the source define the macro NTHEAP PROBE BASE inside the procedure src ntheap allocate heap and rebuild Why does Emacs ask connect dialup service when starts For some users when Emacs starts pops the dialog for connecting their dialup service sometimes appears hang for few minutes and suddenly appear The reason for this that Emacs now has networking support built When Emacs starts the winsock DLL automatically gets loaded and tries resolve the fully qualified domain name for your machine under the name localhost the system doesn have this name mapped will try query nameserver the internet which typically some host within your ISP and subsequently prompts connect your dialup service that can ask name server for the domain name your machine you know this very unfortunate and was not anticipated when the networking support was added This problem will fixed when comes out but you can work around the problem giving the dialup support another method for figuring out the domain name your machine this you need edit the hosts file for your system located windir hosts Win and windir system drivers etc hosts that localhost becomes alias for your machine name your system doesn have hosts file yet you can easily create one copying the sample hosts file the same directory hosts sam For example machine were named banana fish washington edu then would edit the hosts file from localhost banana fish washington edu localhost The hostname should the value invoking system name the Emacs scratch buffer the fully qualified domain name for your system Note that you may also have tell the system look the hosts file well using DNS this doesn work for you there are some other options have not tried these Turn off the auto dial option PPP under the Control Panel Dialup Networking icon However this would mean that you would have manually connect your dialup service whenever you wanted use network applicaton Use dummy winsock dll Cristian Ionescu Idbohrn ltcii kcs has provided one called mozock dll Download the zip file unzip move the mozock dll file the bin directory where emacs exe resides and then rename the mozock dll file wsock dll When Emacs loads will load this wsock dll instead the system one For networking support you can use the external nttcp exe program Download nttcp exe and place your Emacs bin directory Also download this version tcp byte compile and place your lisp directory Then add the following your emacs load library tcp setq tcp program name nttcp Edit the emacs exe executable remove the reference wsock dll the import table Copy emacs exe backup file and then start Emacs you might have connect your service provider this load emacs exe into buffer search for wsock dll turn overwrite mode and then change wsock dll xsock dll changing the Now save the modified emacs exe Now get networking support again follow the directions the previous item Delete all DNS nameservers listed the TCP propoerties the network control panel dialog This rather drastic approach since you will want DNS nameservers when running other applications and even the networking ones inside Emace When run Emacs console window pops How make away This annoying know and you shouldn have dealing with this But please bear with for now isn there already prepend start the last line the bat file the line that invokes the emacs exe executable Then create shortcut icon the emacs bat file and edit the Properties the shortcut right click the icon the Program tab select Run Minimized and make sure the Close exit checkbox checked Double click the icon and Emacs should start cleanly How change the size position font and color attributes Emacs Emacs can run two different interface modes the Windows interface which allows the flexible use and mixture fonts and colors and the console interface which constrains Emacs the limitations console windows The following two sections describe how specify and change the size position font and color attributes Emacs both interface modes Windows Interface With the Windows interface you can change the size position font and color attributes Emacs using three different mechanisms using the mouse with the user interface specifying them command line arguments invoking Emacs Lisp functions You will probably find convenient specify command line arguments the Properties the shortcut the Emacs batch file and invoke the lisp functions your startup file For information how propagate attributes new frames see the section below frames SIZEUser InterfaceTo resize Emacs window drag border with the mouse Command LineTo have Emacs start with particular size invoke with the Windows geometry command line argument For example start Emacs with window lines columns size use the following emacs Note that the geometry command can combined with the position command described below Emacs LispTo change the size Emacs frame using elisp you can use the two functions set frame width and set frame height For example resize Emacs display lines columns you could use set frame height selected frame set frame width selected frame POSITION User InterfaceTo reposition running Emacs click its title bar and drag the window Command LineTo start Emacs particular position invoke with the Windows geometry command line argument For example start Emacs pixel offset from the top left corner emacs combine the size with position first specify the size and then the position The two examples above can combined follows emacs Note that you can also specify position offsets from any the corners the screen See the GEOMETRY SPECIFICATIONS section the man page for complete details the geometry command Emacs LispTo reposition Emacs frame using elisp you can use the set frame position function For example move the current frame the offset you could use set frame position selected frame FONTS Fonts Emacs are named using the standard Windows format for fonts These font names are the names that can used arguments the command line lisp functions see the font name corresponding font chosen using the font selection dialog execute the following elisp code the scratch buffer insert prin string win select font see the complete list fonts that Emacs has access execute the following elisp code the scratch buffer insert prin string list fonts For complete details Windows font names see the FONT NAMES section the man page The font support currently little rough around the edges particular italic fonts give Emacs some problems see below for more info about using italic fonts Generally performs expected but occasionally you might get unexpected results Emacs didn quite use the font you told use Work underway fix these problems but for now suggest experimenting you encounter problems Also Windows has the luxury set font aliases such fixed that are convenient names for referring specific fonts Work underway provide equivalent alias mechanism under Win that naming fonts does not have cumbersome currently User InterfaceTo change the default font that Emacs uses shift click the left mouse button shift mouse and font selection dialog will pop Select the font that you would like use and click the button close the dialog and use the selected font Note that the dialog only displays fixed pitch and screen fonts since Emacs cannot handle variable pitched fonts Command LineTo start Emacs with particular font use the the font Windows command line option For example start Emacs with the Courier font size and font style Regular invoke Emacs using emacs font Courier normal ansi Emacs LispTo change the default font Emacs using elisp use the set default font function set default font Courier normal ansi set the font particular face use the set face font function RegistryTo change the default font Emacs frames using registry entries create value the key HKEY CURRENT USER Software GNU Emacs Value Name Emacs Font Value Type REG String Courier normal ansi Since the font strings are rather cumbersome would suggest cutting the font string into the kill ring which will place the clipboard too and pasting Ctrl into the regedit dialog Note that you shouldn place quotes around the font string the registry you have Emacs frames with specific names you can also specify font for that frame For the Value Name the entry use the name the frame instead Emacs RMAIL Font for your RMAIL frame COLORS with other windowing attributes Emacs uses the Windows color names for specifying colors the command line and elisp One set these names set abstract color names red green and blue These names are the ones you will typically use arguments the command line elisp functions Emacs also supports the use numeric color names see the COLOR NAMES section the man page for complete details how specify numeric color names and their color spaces see the abstract color names that Emacs understands and the colors that they map use the menu command Edit Text Properties Display Colors invoke the list colors display function the scratch buffer list colors display you would like change the mapping color names RGB values add new color names Emacs then you will want modify the alist win color map make changes you can simply cons new mappings onto the head the alist setq win color map cons snow win color map The number the element the logical three values for the red green and blue components the example above red green and blue some point there will support for reading files with color mappings make this process little easier User InterfaceTo change the foreground background color Emacs through the windowing interface you can use the menu commands Foreground Color Other and Background Color Other the Edit Text Properties menu Command LineTo change the foreground background color Emacs the command line you can use the and command line arguments For example start Emacs with yellow text black background invoke Emacs using emacs yellow blackEmacs LispYou can use elisp functions change the colors any the Emacs faces For example change the foreground background color Emacs you can use the set foreground color and set background color functions change the color arbitrary face use the set face foreground and set face background functions change the color the cursor use the set cursor color function The following elisp changes the background color black set background color black The following elisp changes the mode line foreground firebrick set face foreground modeline firebrick The following elisp changes the cursor color purple set cursor color purple FRAMES Emacs uses two alists determine the default appearances frames default frame alist and initial frame alist The default frame alist variable sets the basic defaults all frames Since common Emacs usage have the initial frame have slightly different properties than other frames its position you can use the initial frame alist variable override properties default frame alist specially for the initial frame You should definitely read the help text for these variables for more details the differences between the two variables and how they interact with each other Below example using default frame alist and initial frame alist configure the appearances the initial frame and all other frames you would place this code your startup file With default frame alist set the top left corner new frames pixel offset the width and height the cursor white the foreground yellow the background black and the font Courier With initial frame alist override the top left corner the initial frame pixel offset and inherit the remaining properties for the initial frame from default frame alist setq default frame alist top left width height cursor color white foreground color yellow background color black font Courier normal ansi setq initial frame alist top left ITALICS Emacs currently requires that italic versions fonts have the same width the normal version the font However most the default fonts have italic and italic bold versions whose character widths are larger than the normal version the only default font that appears have viable italic and bold versions Courier New Because this Emacs default disables the use italic faces You can still enable the use italic faces with Emacs setting the variable win enable italics your startup file setq win enable italics This must done before font settings set face font italic Courier New normal ansi set face font bold italic Courier New bold ansi Although this works best with Courier New there still one minor glitch the italics versions are one pixel higher than the other versions the line spacing increased pixel when italics are enabled Console Interface Emacs can also run inside console window Simply invoke Emacs with the command line option Although you cannot change the size font color the window from within Emacs you can use the window menu icon has been created invoke the Emacs batch file then you have create one change these attributes SIZE Under the upper left hand corner and open the menu the console window Select Screen Size and Position and use the dialog set the window the size you want sure check the Save Window Size and Position checkbox that future invocations will retain the new window size After closing the dialog box resize the window itself dragging the edges Under Win click the properties icon the icon toolbar the top the window the Screen tab and select the desired window size the Usage panel Click POSITION reposition Emacs click the title bar the console window and drag FONT Under open the menu Select Fonts and use the dialog set the window font the one you want sure check the Save Configuration checkbox that your font change will used future invocations Click and the window will get resized Under Win simply use the popup font menu the upper left hand corner the window click the font icon the icon toolbar click the properties icon the icon toolbar and the Font tab and choose the font that you want use COLOR Under the interface open the menu Select Screen Colors and use the dialog choose the colors you want use for the window sure check the Save Configuration checkbox that the colors are used future invocations Click Unfortunately the colors are not immediately used but the changes have been made use the new colors simply close the window and use the icon start Emacs again Emacs will then come using the colors you chose before not exactly sure how change the colors per console window basis under Win Where put emacs emacs file Your startup file can named either emacs emacs and should placed your home directory you have both files your home directory Emacs will load the emacs file and ignore emacs Also you have version Emacs older than Emacs will only recognized emacs the startup file Your home directory where the HOME configuration variable tells Emacs with the other Emacs configuration variables HOME can set number ways Environment variable Emacs will always first check see you have environment variable named HOME set and use that value your home directory Under Win you can set the HOME environment variable your autoexec bat file under you can set the HOME environment variable the System panel the Control Panel Note that you set HOME environment variable the System panel will only take effect new processes Registry Emacs doesn find environment variable named HOME will check the registry for value named HOME and use that value your home directory Emacs first checks the key HKEY CURRENT USER SOFTWARE GNU Emacs and then the key HKEY LOCAL MACHINE SOFTWARE GNU Emacs although the use the latter key discouraged since HOME should set per user basis not per machine basis Note that the value HOME not set the addpm exe program that initializes the registry with the other Emacs configuration variables Emacs cannot find HOME set any the above locations will assume your HOME directory The directory specified HOME also the directory substituted for tildes file names definition your startup file will the directory How swap CapsLock and Control CapsLock and Control cannot swapped from within Emacs and Windows does not have convenient mechanism like xmodmap change virtual key bindings Instead new keyboard layouts device drivers need installed swap the two keys WARNING you use new keyboard layout switch CapsLock and Control beware the option use hotkey sequences switch keyboard layouts This option Control Panel Keyboard under the Language Win Input Locales tabs the sequences themselves are Left Alt Control and Ctrl Shift you enable one these options then you will likely some point switch keyboard layouts while trying use Emacs key combination For check out swapcapslock zip James Kittock has provided program for that installs new keyboard layout with the two keys swapped Once installed you can then select using the International control panel applet READMEkeyswap tarWin Microsoft has placed keyboard remapping program for Win their ftp site For more info take look their Kernel Toys page Mark Russinovich has also written freeware VxD that swaps CapsLock and Control under Windows been told that you might have hit the real Control key once after installing the VxD jumpstart the mapping READMEsourcectrl cap vxd tarSubprocesses under Emacs Emacs and Win can utilize subprocesses just like Unix Emacs However the behavior subprocesses with Emacs may unintuitive some situations This section discusses these situations and how you might work around them Programs reading input hang Programs that explicitly use handle the console CON CON instead stdin and stdout cannot used subprocesses Emacs and they will also not work shell mode the default ftp clients Win and are examples such programs There convenient way for either Emacs any shell used shell mode redirect the input and output such processes from the console input and output pipes The only workaround use different implementation the program that does not use the console directly see the discussion ange ftp for replacement for the default ftp clients Buffering shells You may notice that some programs when run shell shell mode have their output buffered people have found this happening them with sql mode When the program has lot output overflows the buffering and gets printed the shell buffer however the program only outputs small amount text will remain buffered and won appear the shell buffer Although may first seem like the shell buffering the output from the program actually the program that buffering output The runtime typically decides how buffer output based upon whether stdout bound handle console window not bound console window output buffered line line bound block device such file output buffered block block shell buffer stdout pipe handle and buffered blocks you would like the buffering behavior your program behave differently the program itself going have changed you can use setbuf and setvbuf manipulate the buffering semantics DOS subprocesses You can run DOS subprocesses under Emacs but with the limitation that you run only one time The implication this that you use command com under Win your shell then you can only run one shell process time command com still DOS process even under Win You can use other shells such bash tcsh instead command com see the section below other tools for pointers other sites Andrew Innes working removing this limitation all goes well should available How use shell Emacs You can use interactive subshell Emacs typing shell Emacs uses the SHELL configuration variable determine which program use the shell you installed Emacs using the addpm exe program then addpm exe will associate the value COMSPEC with SHELL the registry Emacs will then use the value the COMSPEC environment variable when starts unless the SHELL environment variable explicitly defined when using the emacs bat batch file you would like specify different shell for Emacs use then you should one two things You should either explicitly set the environment variable SHELL the shell you want use you want have the COMSPEC environment variable determine the shell then you need install Emacs using the addpm exe program and ensure that the SHELL environment variable not defined when you start Emacs How prevent shell commands from being echoed Some shells echo the commands that you send them and the echoed commands appear the output buffer particular the default shells command com Win and cmd exe have this behavior prevent echoed commands from being printed you can place the following your startup file setq comint process echoes shell mode still not stripping echoed commands then you have explicitly tell the shell not echo commands You can this setting the explicit SHELL args variable appropriately where SHELL the value your shell environment variable getenv SHELL see what currently set Assuming that you are and that your SHELL environment variable set cmd exe then placing the following your startup file will tell cmd exe not echo commands setq explicit cmd exe args The comint package will use the value this variable argument cmd exe every time starts new shell shell mode the the argument cmd exe that stops the echoing shell invoking cmd will show you all the command line arguments cmd exe Note that this variable case sensitive the value your SHELL environment variable CMD EXE instead then this variable needs named explicit CMD EXE args instead Why Specified COMMAND search directory bad message printed The function shell shell automatically invokes the shell program with the argument and parses this the directory which the shell program resides which course invalid prevent this message from being printed you can create variable named according the form specified the help message shell look the help message type shell For the default shells then you could place the following your startup file prevent this message these will eventually get into winnt you don have this setq explicit command com args nil setq explicit COMMAND COM args nil setq explicit cmd exe args nil setq explicit CMD EXE args nil Multiple lines for each shell are given since variable names are case sensitive and shell names can any case this only handles the most common situations you have entirely different shell that also complains about being given the switch you can initialize similarly named variable prevent the switch from being sent the shell Note that you would like always pass arguments interactive shell when starts you would change the nil value the appropriate assignment above the list arguments you would like use with your shell For example you would like invoke command com and tell which directory its executable resides you could place something like the following your startup file Determine the directory containing the shell program explicitly making certain that the directory separator backslash when doing let directory sep char setq shell directory file name directory getenv SHELL setq explicit command com args list shell directory setq explicit COMMAND COM args list shell directory When run programs within shell get Incorrect DOS version messages Why This might happen for example you invoke nmake shell and tries create subshells The problem related the one above where again when the shell initially created the first argument the shell not the directory which the shell program resides When this happens command com fabricates value for its COMSPEC environment variable that incorrect Then when other programs use COMSPEC find the shell they are given the wrong value The fix for this either prevent any arguments from being sent the shell when starts which case command com will use default and correct value for COMSPEC have the first argument the directory which the shell executable resides Examples how both these are shown the previous subsection How use mail with Emacs You not need much use mail with Emacs under Win but you need able communicate with local mail daemons and mail servers they most the work both receive and send mail from your system These daemons and servers are typically running the machines your local network that are already handling mail for you and other users other systems only tested the outgoing and incoming RMAIL setups you find that the suggested code for any the other incoming mail configurations inaccurate please let know Outgoing For outgoing mail you need elisp file smtpmail that enables Emacs talk SMTP with mail daemons smtpmail was written Tomoji Kagatani ltkagatani rbc ncl omron and has been submitted included future distributions You also need add the following your startup file sure customize for you and your system setq user full name Your full name setq user mail address Your email address setq smtpmail default smtp server Domain name machine with SMTP server setq smtpmail local domain nil setq send mail function smtpmail send load library smtpmail Incoming RMAIL and POP For incoming mail using the RMAIL package and POP mail server you need only place the following your startup file again sure customize setenv MAILHOST Domain name machine with POP server setq rmail primary inbox list Your login rmail pop password required Note that you will need customize the Domain name machine with POP server and Your login fields the name your POP server and your login name Incoming and POP For incoming mail using the package and POP mail server you first need the package check any elisp archive and then you need place the following your configuration file setq spool files list list INBOX POP server pass POP user name INBOX CRASH Note that you will need customize the POP server and POP user name fields your login name and the name your POP server You will also probably want customize the name your inbox and crash files INBOX and INBOX CRASH the example above Incoming GNUS You should able use Gnus and above mail reader The following was sent example Marc Fleischeuers ltMarc Fleischeuers kub For sending mail setq message send mail function smtpmail send For reading mail other backends can substituted for nnml setq gnus secondary select methods nnml setq nnmail spool file POP user name setq nnmail pop password required sure customize the POP user name field appropriately don know any complete ports the Win environment but Fabrice POPINEAU ltpopineau esemetz ese metz has made some modifications the version See his description what has done for more info The support programs mentioned can found zip note that they have only been tested though How use ange ftp with Emacs You will need some additional files before ange ftp will work with Emacs Partly this due the unfortunate fact that the ftp program shipped with Win and does not accept password from pipe redirected file and partly this due some incompatibilities the ange ftp lisp file when used Windows Chris Szurgot ltszurgot itribe net has been working both these problems has version ftp that solves the password problem and version ange ftp that deals with the incompatibilities You can find both his ftp server ftp ftp itribe net pub virtunix ftp ziphttp www itribe net virtunix files emacs ange ftp Place the ftp exe executable directory where you keep your local executables and the ange ftp file whatever directory you keep custom and personalized elisp files you will probably also want byte compile ange ftp too Then sure that the exec path variable set that when Emacs runs the ftp exe program runs the one you downloaded and not the default one Likewise sure set load path that when ange ftp invoked the ange ftp file you downloaded gets loaded instead the default one example assuming that you placed ftp exe say HOME bin and ange ftp HOME elisp you could set exec path and load path follows your startup file setq exec path cons expand file name bin exec path setq load path cons expand file name elisp load path another alternative you can tell ange ftp exactly which ftp program use customizing ange ftp ftp program name setq ange ftp ftp program name bin ftp exe With this method you don have worry about the wrong ftp program being picked through exec path You will also want customize the temporary directory that ange ftp uses cache files setq ange ftp tmp name template concat expand file name getenv TEMP ange ftp setq ange ftp gateway tmp name template concat expand file name getenv TEMP ange ftp Note that this particular ftp client was ported pretty much only for use with Emacs you looking for snazzier ftp client for more general use you might want look the ncftp client Chris ftp server How use telnet with Emacs far know there telnet client that you can successfully use subprocess Emacs and telnet mode does not work Most telnet clients for Windows are GUI apps that use their own windows Emacs requires console app that works with pipes get telnet working with Emacs see two possibilities One implement version telnet that talks the telnet protocol directly the gnus implementation skipping the telnet program altogether The other possibility implement console version telnet Chris Szurgot ltszurgot itribe net has console app telnet his ftp server see ftp ftp itribe net pub virtunix telc zip but unfortunately uses direct console input and output This version can hacked use stdin and stdout and then could used Emacs subprocess How use crypt with Emacs The crypt package doesn yet work out the box with Emacs Win David Rosinger ltdsrosing fed reston ingr com modified crypt that would work commenting This package will allow you transparently visit tar tar and DOS files However occasion certain tar files lock emacs don know why but killing gzip frees emacs again Download this version crypt and place somewhere your load path You also need the compression uncompression utilities look ftp washington edu pub ntemacs utilities your exec path How use the browse url package Caleb Deupree has put together package for intergrating browse url with Emacs Win First pick the latest browse url from http wombat doc emacs browse url note that this much more recent version than shipped with Emacs and set per the instructions that file Then download and install the shelex exe program making sure that your exec path The code for shelex exe shelex Then add the following commands your startup file defvar shell execute helper shelex exe defun shell execute url url optional new window Invoke the shell execute helper program call ShellExecute and launch direct web browser the specified url interactive sURL call process shell execute helper nil nil nil url setq browse url browser function shell execute url setq gnus button url shell execute url GNUS setq url browser shell execute url This works with the default browser your system whether something else However you must have installed your system for work with other browsers the dll that makes this all work WININET DLL only gets installed when installed How use Emacs with two button mouse Emacs assumes that you have three button mouse default However you have two button mouse you can press both buttons once emulate the missing middle button expected Emacs you have three button mouse but the middle mouse button does not work for you skip the end this section Three variables control mouse button emulation under Emacs win num mouse buttons win mouse button tolerance and win swap mouse buttons you use help win num mouse buttons with will tell you how many buttons Emacs thinks your mouse has win num mouse buttons less than then Emacs will emulate the middle mouse button Emacs emulates the middle mouse button treating simultaneous button presses the left and right buttons middle button press Since presses both buttons cannot really simultaneous Emacs compares button presses within specified window time determine whether should emulate the middle button This window time controlled using win mouse button tolerance Help this variable will show you the value Emacs uses default and you can change this value suit your needs Depending upon the type two button mouse you may find useful swap the mapping middle and right mouse buttons default the middle button mapped mouse and the right button mapped mouse you set win swap mouse buttons non nil value then you can swap these two mappings Some people find that they have three button mouse but the middle mouse button does not work for them First check see win num mouse buttons set correctly then check see whether your mouse has been installed with the proper driver open Control Panel Mouse examine the driver being used nothing seems amiss then the very least you can have Emacs emulate the middle button setting win num mouse buttons How highlight the region between the point and the mark highlight the region between the point and the mark use the function transient mark mode transient mark mode How change the sound the Emacs beep You can use the function set message beep change the sound that Emacs uses for its beep Emacs allows you specify one the Windows system sounds for the beep For example use the system sound place the following your startup file set message beep Look help for the function for complete description how use the function and which sounds recognizes How display ISO characters display ISO characters place the following your startup file standard display european input bit characters you may also need adjust the input mode from Johan Myreen jem vistacom set input mode car current input mode nth current input mode How print from Emacs Pascal Obry has nice example how set some variables get printing work Jeff Paquette ltpaquette ici net has version for use with Emacs and instructions how set Vassil Peytchev ltvassil msn fullfeed com has example how use ghostscript print non postscript printers there package for editing Windows specific files bat ini inf etc Peter Breton ltpbreton kinetics com has written package called generic mode for editing Windows specific files such bat ini inf reg and rul files Download generic mode and generic extras place them somewhere your load path byte compile them and then follow the instructions the top file use them How associate files with Emacs You can use package like gnuserv associate files with Emacs that opening file outside Emacs double clicking its icon will create new frame running Emacs displaying that file Peter Breton ltpbreton dirac kinetics com ported version gnuserv that used named pipes Since Win doesn support named pipes Nico Francois ltNico Francois scala modified again use mailslots that would work both platforms Nico distribution gnuserv zip updated README Note that you can set file associations Win using Explorer selecting the View Options menu operation and then clicking the File Types tab the dialog that pops Clicking file type will allow you edit and associate the file with gnuclient exe Comments from Nico made some small modifications and now there gnuclientw exe included which compiled Windows program will also force the flag doesn hang around for nothing Ideal used for file associations Also rather cool put shortcut gnuclientw exe your desktop and have the ability drag drop files into Emacs How access UNIX files via NFS you mount UNIX file systems onto your machine with samba and you would like prevent your files from being translated the DOS format you can use using unix filesystems placing the following using unix filesystems your startup file Note though that this has Emacs treat all files they were UNIX filesystem which can very limiting future replacement for using unix filesystems are the functions the end untranslate These functions enable you turn and off translation individual filesystem basis you want use these functions download and place untranslate your load path and have loaded from your startup file Then you can place calls add untranslated filesystem selectively access filesystems binary mode there mode for editing Visual Basic source Fred White ltfwhite world std com has written package for editing Visual Basic source Download basic mode place your load path and follow the directions the top the file use Fred comments Here simple mode for editing programs written The World Most Sucessful Programming Language features indentation font locking keyword capitalization and some other convenience functions there version RCS for Win You can find collection the RCS executables rcs zip was told Mark Alexander ltmarka daddy pepper com did the port Executables provided Peter Breton ltpbreton dirac kinetics com don have any source Note that use RCS you will also need copy gnu diff there version ispell for Win Henry Thorpe has ltthorpe iew sed monmouth army mil has ported somewhat hacked version ispell Win You can get from his ftp server ftp www sesd ilex com pub thorpe ispell cygnus hacked zip Brian Tibbetts lttibbetts cat rpi edu has also done some work making ispell more Win friendly Check out his page http cat rpi edu tibbetts ispell toc html his latest update Does Emacs support popup menus The standard distribution does not yet support popup menus like the Unix version does Mark Jungerman ltmjungerm oracle com and lthsexton oracle com apologies seem have lost your name have implemented popup menu support although its programming semantics are slightly different than the standard Emacs popup menu semantics Jake Colman ltjcolman jnc com trying remedy this situation you would like use what they have implemented you can download their patches which were made the source BUGS Below list the most obvious bugs that users typically encounter aware that these bugs exist there need send bug report either the mailing list know workaround mention along with the description the bug time will grow this list more comprehensive list bugs ange ftp ange ftp and UNC file names cause confusion names the form server top are being expanded server top untranslate Inserting file into buffer changes the buffer type the type the inserted file color names color names the forms RRRGGGBBB RGB RRR GGG BBB RGBi RRR GGG BBB etc are not parsed and converted windows colors faces and new frames Some face definitions are not used when new frame created with Alt These keys are not handled correctly some keyboard layouts The keys delete del and backspace don work expected fix this put the following your startup file global set key delete global set key delete global set key backspace Autosave files become the same file the original file foo bat and foo bat refer the same file This problem actually bug Windows you can use the DOS move command reproduce the bug You can workaround this bug placing the following your startup file setq backup copying Note that this workaround only works for autosave files though Pop menus aren implemented The Control and Meta keys can get stuck such that Emacs thinks they are being pressed when they are not workaround toggle the keys couple times get Emacs back track RCS menu commands are greyed out when they seemingly shouldn Emacs gets fatal error when loading folder while starting the package Emacs doesn load the startup file emacs even though HOME set correctly can reproduce this this happening someone who can also debug Emacs would appreciate your trying track down what going workaround invoke Emacs with the HOME emacs command line argument ange ftp doesn work because the colons workaround Fixed Bookmarks from the menu don seem work CapsLock acts like shift key The desktop library doesn work delimiter problem The paste menu item doesn correspond the clipboard yank does though Getting file attributes locked files doesn work Emacs loses keyboard input after has been iconified workaround for this maximize the window and then return its normal size Scrollbars aren supported workaround emacs doesn work have Emacs run console window has compiled Fixed but still doesn work inside telnet window emacsclient and server are not supported Keyboard macros with search don always work Setting debug error crashes Emacs get these strange error messages What wrong shell etc fails with Invalid read syntax shell etc fails with Symbol value variable void These error messages appear when precompiled source distribution has been unpacked incorrectly See the Note unpacking the distributions above the source this problem and how solve Symbol value variable void pressions This error message appears during the dumping phase when compiling source distribution that has been unpacked incorrectly See the Note unpacking the distributions above the source this problem and how solve produces Can spawn When Emacs suspends actually creates and runs new shell uses the SHELL environment variable determine which shell run this environment variable set incorrectly the above error message will appear Change your SHELL environment variable valid shell solve this problem Win Specific ProblemsI get these Out environment space messages Why The emacs bat script sets number environment variables that are used Emacs function properly The console process which the script executed runs out memory which set these environment variables causing mess problems get around this problem create shortcut icon the emacs bat script Then right click the icon and select Properties the dialog box that pops select the Memory tab and then change the Environment memory allocation from Auto Close the dialog box and then double click the icon start Emacs The ESC key doesn seem work Win Why early beta versions Win ESC key events were not propagated Emacs you are still using early beta version then you will have upgrade your version Win solve this problem Emacs doesn refresh correctly Why Even with the official release Win there seems bug that confuses Emacs when refreshes the screen under certain circumstances workaround being implemented the next version When will the Win version have subprocess support Due legal technicalities contributed work subprocess support will arrive shortly after has been officially released through the FSF Andrew Innes contributing this code well many other bug fixes All kudos Andrew Patches Below are sets patches that fix specific bugs and are organized release They are only useful you have the source Emacs Note also that they not represent the set differences between one major release and the next they are typically patches popular problems patches that sent the list Enable Emacs compiled with Emulate getuid and geteuid Fix menu update problem Makes TrueType and italic fonts usable Only update the menu when absolutely necessary elisp file with palette RGB values for colors What other Unix tools have been ported and Windows Probably the first place you should look for more GNU tools Cygnus the GNU Win project which not only trying port the GNU tools Win but also provide libraries that allow Unix programs use Win without modification The project http www cygnus com misc gnu win older set the GNU tools that have seen offered ftp sites for and Win have been based the Congruent tools have heard mixed reviews these ports use with your own discretion ftp site that seems offer the full set these tools ftp utexas edu microlib gnu Microsoft also has collection tools for use with including Unix tools such cron kill and nice well number specific tools list these tools http www microsoft com ntserver tools Maintnce htm you perl user then you probably want the port perl Win Check out HIP Communication port perl for Win David Wihl maintaining FAQ about porting Unix applications can found http www shore net wihl unix html Chris Szurgot also collecting and implementing Unix style tools for Windows and presumably See http www itribe net virtunix Jeff Paquette ltpaquette ici net has collection the GNU text utilities for Win See http www tiac net users paquette WinProgramming html What the name the Emacs mailing list The name the Emacs mailing list ntemacs users washington edu majordomo administered list you would like subscribe the mailing list send message ntemacs users request washington edu with the word subscribe the body the message unsubscribe from the list send message ntemacs users request washington edu with the word unsubscribe the body the message Please not send the unsubscribe message the list itself but the request alias instead Sending the message the list does not unsubscribe you from and tends annoying people the list you are trying unsubscribe from the list but are encountering problems send mail directly and will manually remove you from the list Again not send mail the list complaining that you cannot unsubscribe from From the list info message The list ntemacs users washington edu forum for discussion related using GNU Emacs Windows and Windows Please feel free ask and answer any questions related Emacs Win you see fit although ask that questions regarding general use Emacs directed the Emacs Info files and the general Emacs news groups such comp emacs and gnu emacs help will also sending announcements about new releases and bug fixes this list These announcements should relatively infrequent however Where are the archives for ntemacs users The ntemacs users list being archived hypermail The gaps between archived directories are due mail being thrown away hypermail Latest datesubjectauthorJune August datesubjectauthorAugust October datesubjectauthor Note that may occasionally trim the archive chews disk space Geoff Voelker voelker washington edu 